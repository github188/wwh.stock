!function () {
    function t(t, e) {
        this.view = t, e && (this.param = queryString.parse(e));
    }
    function e(t, e) {
        return y = "000" + t, y.substr(y.length - e);
    }
    function a(t) {
        this.moreID = t;
    }
    function n(t) {
        this.container = t || n.prototype.container;
    }
    var r = { "2_-1": "http://nufm.dfcfw.com/EM_Finance2014NumericApplication/JS.aspx?type=CT&cmd=C._BKHY&sty=FCCS&st=c&p=1&ps=20&cb=&js=var%20BKtrade%20={Trade:[[(x)]]}&token=d0075ac6916d4aa6ec8495db9efe7ede", "2_1": "http://nufm.dfcfw.com/EM_Finance2014NumericApplication/JS.aspx?type=CT&cmd=C._BKHY&sty=FCCSL&st=c&p=1&ps=20&cb=&js=var%20BKtrade%20={Trade:[[(x)]]}&token=d0075ac6916d4aa6ec8495db9efe7ede", "3_-1": "http://nufm.dfcfw.com/EM_Finance2014NumericApplication/JS.aspx?type=CT&cmd=C._BKGN&sty=FCCS&st=c&p=1&ps=20&cb=&js=var%20BKnotion%20={Notion:[[(x)]]}&token=d0075ac6916d4aa6ec8495db9efe7ede", "3_1": "http://nufm.dfcfw.com/EM_Finance2014NumericApplication/JS.aspx?type=CT&cmd=C._BKGN&sty=FCCSL&st=c&p=1&ps=20&cb=&js=var%20BKnotion%20={Notion:[[(x)]]}&token=d0075ac6916d4aa6ec8495db9efe7ede", "1_-1": "http://nufm.dfcfw.com/EM_Finance2014NumericApplication/JS.aspx?type=CT&cmd=C._BKDY&sty=FCCS&st=c&p=1&ps=20&cb=&js=var%20BKArea%20={Area:[[(x)]]}&token=d0075ac6916d4aa6ec8495db9efe7ede", "1_1": "http://nufm.dfcfw.com/EM_Finance2014NumericApplication/JS.aspx?type=CT&cmd=C._BKDY&sty=FCCSL&st=c&p=1&ps=20&cb=&js=var%20BKArea%20={Area:[[(x)]]}&token=d0075ac6916d4aa6ec8495db9efe7ede" }, i = { area: "?bklb=1&jsName=BKArea&sr=-1", notion: "?bklb=3&jsName=BKnotion&sr=-1", trade: "?bklb=2&jsName=BKtrade&sr=-1", bkqueryqc20: "http://nufm.dfcfw.com/EM_Finance2014NumericApplication/JS.aspx?type=CT&cmd=C._BK&sty=DCRRBKCPALTA&st=c&sr=-1&p=1&ps=10&cb=&js=var bkqueryqc20 = {Top:[[(x)]]}&token=d0075ac6916d4aa6ec8495db9efe7ede" }, s = { chart: new ChartView(mini("#hsindex img")), init: function () {
        s.chart.render();
    }, update: function () {
        quote.HSOpening && this.chart.render();
    } };
    s.init();
    var o = { load: function () {
        var t = (new Date).format("yyyyMMddHHmm"), e = this;
        ajax.getScript(i.bkqueryqc20 + "&dt=" + t, "gb2312", function () {
            e.render(bkqueryqc20.Top[0]);
        });
    }, update: function () {
        quote.HSOpening && this.load();
    }, container: mini("#lzbk")[0], lazyElem: mini("#lzbk")[0], render: function (t) {
        for (var e, a = '<table class="data-table1" width="100%"><tr><th>板块名称</th><th>涨跌幅</th><th>领涨股</th></tr>', n = '<tr><td><a href="'+portalurl+'marketlist#2800{$data[7]}{$xxcode}_0_2" target="_self">{$data[2]}</a></td><td><span class="numeric {$css}">{$data[3]}</span></td><td><a href="'+portalurl+'stockeast/detail?stockCode={$data[5]}" target="_self">{$data[6]}</a></td></tr>', r = "</table>", i = new Repeater(a, n, r), s = 0, o = t.length; o > s; s++) {
            dataRow = String(t[s]).split(","), e = quote.getCssByChange(parseFloat(dataRow[3])), i.set("data", dataRow), i.set("css", e);
            var c = dataRow[1].substr(3);
            i.set("xxcode", c), i.parse();
        }
        this.container.innerHTML = i.toHTML();
    } };
    t.prototype = { param: queryString.parse("&bklb=2&p=10&jsName=BKtrade&sr=-1"), charset: "gb2312", init: function () {
    }, onloaded: function (t) {
        var e, a = [];
        a["1"] = "Area", a["2"] = "Trade", a["3"] = "Notion", e = a[this.param["bklb"]], t = t[e][0], this.view.render(t);
    }, load: function () {
        var t, e = this;
        r[e.param.bklb + "_" + e.param.sr] && (t = r[e.param.bklb + "_" + e.param.sr] + "&" + queryString.serialize(e.param) + "&dt=" + +new Date, ajax.getScript(t, e.charset, function () {
            e.onloaded(window[e.param.jsName]);
        }));
    }, update: function () {
        quote.HSOpening && this.load();
    } }, a.prototype = { moreID: "", data: { type: "trade", sortRule: "-1" }, template: { more: '<a href=portal_url+"stockeast/bklist#{$type}_0_0?sortRule={$sortRule}" target="_self">更多</a>' }, replace: function (t) {
        return t.replace(/\{\$type\}/g, this.data.type).replace(/\{\$sortRule\}/g, this.data.sortRule);
    }, render: function (t) {
        this.data = t, mini(this.moreID)[0].innerHTML = this.replace(this.template.more);
    } }, n.prototype = { type: 2, container: mini("#HYBKUP")[0], template: { header: '<table class="data-table" width="100%"><tr><th>排名</th><th>板块名称</th><th>相关资讯</th><th>涨跌幅</th><th>成交量</th><th>换手率</th><th>上涨家数</th><th>下跌家数</th><th>涨跌股票</th><th>涨跌幅</th></tr>', repeatItem: '<tr><td>{$increment}</td><td><a href="'+portalurl+'marketlist#2800{$xxlb}{$xxcode}_0_2" target="_self">{$data[2]}</a></td><td>{$yb}<a href="http://data.eastmoney.com/bkzj/{$xxcode}.html" target="_blank">资金流</a>{$guba}</td><td><span class="{$bkcss}">{$data[3]}</span></td><td><span class="digi">{$data[10]}</span></td><td><span class="digi">{$data[4]}</span></td><td><span class="digi red">{$szjs}</span></td><td><span class="digi green">{$xdjs}</span></td><td><a href="'+portalurl+'stockeast/detail?stockCode={$data[6]}" target="_self">{$data[8]}</a></td><td><span class="{$stockcss}">{$data[9]}</span></td></tr>', footer: "</table>" }, render: function (t) {
        for (var a = this.container, n = this.template.header, r = this.template.repeatItem, i = this.template.footer, s = new Repeater(n, r, i), o = [], c = "", d = "", p = 0, l = t.length; l > p; p++) {
            o = t[p].split(","), s.set("data", o);
            var m = +o[3].replace("%", "") > 0 ? "digi-up" : +o[3].replace("%", "") < 0 ? "digi-down" : "";
            s.set("bkcss", m), s.set("prefix", "1" == quote.getMarkesBycode(o[6]) ? "sh" : "sz");
            var h = o[1].substr(3);
            s.set("xxcode", h), s.set("xxlb", this.type);
            var b = o[5].split("|");
            s.set("szjs", b[0]), s.set("xdjs", b[2]);
            var u = +o[9].replace("%", "") > 0 ? "digi-up" : +o[9].replace("%", "") < 0 ? "digi-down" : "";
            s.set("stockcss", u), 2 == this.type ? (c = ' <a href="http://guba.eastmoney.com/list,bk' + e(h, 4) + '.html"  target="_blank">股吧</a>', d = '<a href="http://data.eastmoney.com/report/' + h + 'yb.html" target="_blank">研报</a> ') : 3 == this.type ? (c = ' <a href="http://guba.eastmoney.com/list,bk' + e(h, 4) + '.html"  target="_blank">股吧</a>', d = "") : (c = "", d = ""), s.set("yb", d), s.set("guba", c), s.parse();
        }
        a.innerHTML = s.toHTML();
    } };
    var c = new a("#hymore"), d = new n, p = new t(d, i.trade), l = new a("#gnmore"), m = new n(mini("#GNBKUP")[0]);
    m.type = 3;
    var h = new t(m, i.notion), b = new a("#dymore"), u = new n(mini("#DYBKUP")[0]);
    u.type = 1;
    {
        var f = new t(u, i.area), w = [o], g = new LazyTimer(15e3), k = g.add(p), v = g.add(h), _ = g.add(f);
        g.add(s);
    }
    g.add(o), p.lazyElem = d.container, h.lazyElem = m.container, f.lazyElem = u.container, g.start();
    var x = { init: function () {
        w.push(p), w.push(h), w.push(f);
    }, "tab-0": function () {
        p.view["type"] = 2, p.view["container"] = mini("#HYBKUP")[0], p.param["sr"] = -1, p.load(), c.render({ type: "trade", sortRule: 0 });
    }, "tab-1": function () {
        p.view["type"] = 2, p.view["container"] = mini("#HYBKDOWN")[0], p.param["sr"] = 1, p.load(), c.render({ type: "trade", sortRule: 1 });
    }, "tab-2": function () {
        h.view["type"] = 3, h.view["container"] = mini("#GNBKUP")[0], h.param["sr"] = -1, h.load(), l.render({ type: "notion", sortRule: 0 });
    }, "tab-3": function () {
        h.view["type"] = 3, h.view["container"] = mini("#GNBKDOWN")[0], h.param["sr"] = 1, h.load(), l.render({ type: "notion", sortRule: 1 });
    }, "tab-4": function () {
        f.view["type"] = 1, f.view["container"] = mini("#DYBKUP")[0], f.param["sr"] = -1, f.load(), b.render({ type: "area", sortRule: 0 });
    }, "tab-5": function () {
        f.view["type"] = 1, f.view["container"] = mini("#DYBKDOWN")[0], f.param["sr"] = 1, f.load(), b.render({ type: "area", sortRule: 1 });
    } }, C = new TabView;
    C.tabs = mini("#hybk li"), C.panels = mini("#hybkpanels .tab-panel"), C.init("click", "current"), C.onchange = function (t) {
        var e = "tab-" + t;
        x[e](), p.lazyElem = p.view.container, g.set(k, p);
    };
    var B = new TabView;
    B.tabs = mini("#gnbk li"), B.panels = mini("#gnbkpanels .tab-panel"), B.init("click", "current"), B.onchange = function (t) {
        var e = "tab-" + (2 + t);
        x[e](), h.lazyElem = h.view.container, g.set(v, h);
    };
    var $ = new TabView;
    $.tabs = mini("#dybk li"), $.panels = mini("#dybkpanels .tab-panel"), $.init("click", "current"), $.onchange = function (t) {
        var e = "tab-" + (4 + t);
        x[e](), f.lazyElem = f.view.container, g.set(_, f);
    }, x["init"](), lazyModel(w);
}();
